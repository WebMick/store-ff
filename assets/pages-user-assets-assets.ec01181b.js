import{u as s,r as e,c as a,a7 as t,d as l,e as i,w as u,f as d,i as r,h as c,j as o,t as n,m as v,ad as _,x as m,k as b,l as y,F as f,n as p,q as g,A as h,p as $}from"./index-1326579e.js";import{d as T,_ as k,a as A,b as N,c as j,e as x}from"./dayjs.min.5f9aec22.js";import{_ as w,o as I,a as Y,c as M,d as V,r as C}from"./uni-app.es.a60443e8.js";import{_ as D,a as F}from"./y-tabs.d2665ce6.js";import{_ as O}from"./uni-load-more.16e4c6a9.js";import{_ as z}from"./w-loading.4fc13da4.js";import{h as R,i as S,j as U}from"./user.2b7a6c52.js";import{t as q}from"./utils.6d9bcde1.js";import"./uni-icons.e2da828d.js";const B=w({__name:"assets",setup(w){const{t:B}=s(),H=d(),J=e(!1),P=e([{id:3,label:B("user.t72"),status:2},{id:1,label:B("user.t71"),status:"0,1,2,3,4,5,6,7"}]),E=e(0),G=s=>{J.value=!0,1!=E.value?ls(Z).finally((()=>{J.value=!1})):is(Z).finally((()=>{J.value=!1}))};e(!1);const K=T(),L=e([K.day(K.day()-29).format("YYYY-MM-DD"),K.format("YYYY-MM-DD")]),Q=a((()=>Math.ceil((T(L.value[1]).unix()-T(L.value[0]).unix())/60/60/24))),W=s=>{let e=setTimeout((()=>{J.value=!0,ts(Z.value).finally((()=>{J.value=!1})),clearTimeout(e)}),17)},X=a((()=>P.value[E.value].status)),Z={pageSize:20,pageNo:1};J.value=!0,ts(Z).finally((()=>{J.value=!1})),I((()=>{J.value||(J.value=!0,ts(Z).finally((()=>{J.value=!1})))})),Y((s=>{E.value=+s.type||0}));const ss=e({}),es=a((()=>ss.value[E.value])),as=e({});function ts(s){return R({userId:H.state.userinfo.userId,startTime:L.value[0]+" 00:00:00",endTime:L.value[1]+" 23:59:59"}).then((s=>{200===s.data.code&&(as.value=s.data.result||{})})).catch((s=>{console.error(s)})),ls(s),is(s)}function ls(s){return S({...s,startTime:L.value[0]+" 00:00:00",endTime:L.value[1]+" 23:59:59",userId:H.state.userinfo.userId}).then((e=>{var a,t,l,i;200===e.data.code&&(1==s.pageNo?ss.value[0]=null==(a=e.data)?void 0:a.result:ss.value[0]={...null==(t=e.data)?void 0:t.result,records:ss.value.records.concat((null==(i=null==(l=e.data)?void 0:l.result)?void 0:i.records)||[])})})).catch((s=>{console.error(s)}))}function is(s){return U({...s,userId:H.state.userinfo.userId,type:X.value}).then((e=>{var a,t,l,i;200===e.data.code&&(1==s.pageNo?ss.value[1]=null==(a=e.data)?void 0:a.result:ss.value[1]={...null==(t=e.data)?void 0:t.result,records:ss.value.records.concat((null==(i=null==(l=e.data)?void 0:l.result)?void 0:i.records)||[])})})).catch((s=>{console.error(s)}))}const us=[{value:"more"},{value:"loading"},{value:"noMore"}],ds=e({contentdown:B("message.t2"),contentrefresh:B("message.t3"),contentnomore:B("message.t4")}),rs=a((()=>{var s,e,a;return J.value?us[1].value:(null==(s=es.value)?void 0:s.total)>(null==(a=null==(e=es.value)?void 0:e.records)?void 0:a.length)?us[0].value:us[2].value}));return M((()=>{ts(Z).finally((()=>{t()}))})),V((()=>{var s;es.value.total>(null==(s=es.value)?void 0:s.records.length)&&ts({pageSize:Z.pageSize,pageNo:+es.value.current+1})})),(s,e)=>{const a=C(g("uni-datetime-picker"),k),t=C(g("uni-th"),A),d=C(g("uni-tr"),N),T=C(g("uni-td"),j),w=C(g("uni-table"),x),I=C(g("y-tab"),D),Y=h,M=C(g("uni-load-more"),O),V=C(g("y-tabs"),F),R=C(g("w-loading"),z),S=r;return l(),i(S,{class:"ano-page ano-myOrder"},{default:u((()=>[c(V,{class:"myOrder-tabs",modelValue:E.value,"onUpdate:modelValue":e[2]||(e[2]=s=>E.value=s),color:"#1F1F1F",onChange:G},{default:u((()=>[c(I,{class:"van-tab-rebates",title:P.value[0].label},{default:u((()=>{var r,p;return[o("div",{class:"assets-rebates-card"},[o("div",{class:"rebates-card__summary"},[o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"代理商收入"),o("div",{class:"rebates-card__t4"},n(v(q)(as.value.totalAmount)),1)]),o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"直接收入"),o("div",{class:"rebates-card__t4"},n(v(q)(as.value.firstAgentTotalAmount)),1)]),o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"间接收入"),o("div",{class:"rebates-card__t4"},n(v(q)(as.value.secondAgentTotalAmount)),1)]),o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"团队成员"),o("div",{class:"rebates-card__t4"},n(v(q)((+as.value.firstAgentNum||0)+(+as.value.secondAgentNum||0),0)),1)]),o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"直接代理"),o("div",{class:"rebates-card__t4"},n(v(q)(as.value.firstAgentNum,0)),1)]),o("div",{class:"rebates-card__cell"},[o("div",{class:"rebates-card__t3"},"间接代理"),o("div",{class:"rebates-card__t4"},n(v(q)(as.value.secondAgentNum,0)),1)])]),o("div",{class:"rebates-card__date"},[c(a,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=s=>L.value=s),type:"daterange",onChange:W,onTouchmove:e[1]||(e[1]=_((()=>{}),["stop"]))},{default:u((()=>[m(n(L.value[0])+" - "+n(L.value[1])+" ",1),o("div",{class:"rebates-card__day"},n(+v(Q)+1)+n(s.$t("user.t64")),1)])),_:1},8,["modelValue"])])]),o("div",{class:"assets-rebates-list"},[c(w,{class:"ano-table rebates-table",emptyText:J.value||(null==(p=null==(r=v(es))?void 0:r.records)?void 0:p.length)?"":s.$t("user.t65")},{default:u((()=>{var e;return[c(d,null,{default:u((()=>[c(t,{align:"center",style:{width:"25%"}},{default:u((()=>[o("div",{class:"ano-table__th-cell"},n(s.$t("user.t66")),1)])),_:1}),c(t,{align:"center",style:{width:"25%"}},{default:u((()=>[o("div",{class:"ano-table__th-cell"},n(s.$t("user.t67")),1)])),_:1}),c(t,{align:"center",style:{width:"25%"}},{default:u((()=>[o("div",{class:"ano-table__th-cell"},n(s.$t("user.t68")),1)])),_:1}),c(t,{align:"center",style:{width:"25%"}},{default:u((()=>[o("div",{class:"ano-table__th-cell"},n(s.$t("user.t69")),1)])),_:1})])),_:1}),(l(!0),b(f,null,y(null==(e=v(es))?void 0:e.records,(s=>(l(),i(d,{key:s.userId,onClick:e=>{$({url:`/pages/user/assets/subProxy?userId=${s.userId}&startTime=${L.value[0]+" 00:00:00"}&endTime=${L.value[1]+" 23:59:59"}`})}},{default:u((()=>[c(T,null,{default:u((()=>[o("div",{class:"ellipsis1"},n(null==s?void 0:s.userName),1)])),_:2},1024),c(T,null,{default:u((()=>[o("div",{class:"ano-table__num"},n((null==s?void 0:s.selfRebatesAmount)||0),1)])),_:2},1024),c(T,null,{default:u((()=>[o("div",{class:"ano-table__num"},n((null==s?void 0:s.subRebatesAmount)||0),1)])),_:2},1024),c(T,null,{default:u((()=>[o("div",{class:"ano-table__num"},n((null==s?void 0:s.transNum)||0),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))]})),_:1},8,["emptyText"])])]})),_:1},8,["title"]),c(I,{title:P.value[1].label},{default:u((()=>{var e,a,t,d,r,_;return[(null==(a=null==(e=v(es))?void 0:e.records)?void 0:a.length)?(l(),b("div",{key:0,class:"myOrder-orders"},[(l(!0),b(f,null,y(null==(t=v(es))?void 0:t.records,(e=>{var a,t;return l(),b("div",{class:"assets-item",key:e.id},[0==e.type?(l(),b(f,{key:0},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t52")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t55",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),1==e.type?(l(),b(f,{key:1},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t53")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t56",[e.bank,null==(t=e.accountNo)?void 0:t.slice((null==(a=e.accountNo)?void 0:a.length)-4),v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),7==e.type?(l(),b(f,{key:2},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t54")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t57",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),2==e.type?(l(),b(f,{key:3},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t5701")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t5702",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),3==e.type?(l(),b(f,{key:4},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t5707")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t5708",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),4==e.type?(l(),b(f,{key:5},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t5709")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t5710",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),5==e.type?(l(),b(f,{key:6},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t5703")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t5704",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0),6==e.type?(l(),b(f,{key:7},[o("div",{class:"assets-item__title"},[o("div",{class:"assets-item__t1"},n(s.$t("user.t5705")),1),o("div",{class:"assets-item__t2"},n(1==e.symbol?"+":"-")+n(v(q)(e.amount)),1)]),o("div",{class:"assets-item__sub"},[o("div",{class:"assets-item__t3"},n(s.$t("user.t5706",[v(q)(e.amount)])),1),o("div",{class:"assets-item__date"},n(e.createTime),1)])],64)):p("",!0)])})),128))])):p("",!0),(null==(r=null==(d=v(es))?void 0:d.records)?void 0:r.length)||J.value?p("",!0):(l(),b("div",{key:1,class:"ano-empty"},[o("div",{class:"ano-empty__img"}),c(Y,{class:"ano-empty__text"},{default:u((()=>[m(n(s.$t("user.t58")),1)])),_:1})])),(null==(_=v(es))?void 0:_.records.length)?(l(),i(M,{key:2,status:v(rs),"content-text":ds.value},null,8,["status","content-text"])):p("",!0)]})),_:1},8,["title"])])),_:1},8,["modelValue"]),c(R,{show:J.value},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-b21a3260"]]);export{B as default};
