import{u as e,f as a,c as t,r as o,q as s,d as l,e as r,w as n,h as c,x as u,t as d,i,P as v,R as f,ag as p,aG as m,v as _,k as y,j as g,n as h,m as k,F as w,p as b,a2 as C,G as S,aF as I,a7 as x,l as $,A as F}from"./index-1326579e.js";import{_ as T}from"./uni-countdown.d792fe97.js";import{_ as j,r as O,a as N,o as G,c as R,d as z,b as P}from"./uni-app.es.a60443e8.js";import{_ as A}from"./uni-load-more.16e4c6a9.js";import{_ as D}from"./w-loading.4fc13da4.js";import{_ as E}from"./uni-popup.2c319495.js";import{t as L,v as M,b as q,w as B}from"./user.2b7a6c52.js";const H=j({__name:"pay-type-dialog",props:{show:{type:Boolean,default:()=>!1},cancelCallback:{type:Function,default(){}},confirmCallback:{type:Function,default(){}}},setup(m,{expose:_}){const y=m,{t:g}=e(),h=a(),k=t((()=>h.state.userinfo)),w=o(["0"]),b=e=>{w.value=e.detail.value};t((()=>{let e=g("user.t16502"),a=+(k.value.shelfIntervalTime||0);return a>=60&&(e=g("user.t16501"),a=Math.ceil(a/60)),g("user.t165",[a,e])}));const C=o(null);function S(){y.cancelCallback&&y.cancelCallback(),C.value.close()}function I(){y.confirmCallback(w),C.value.close()}return _({open:()=>{w.value=["0"],C.value.open()}}),(e,a)=>{const t=i,o=v,m=f,_=p,y=O(s("uni-popup"),E);return l(),r(y,{class:"pay-type-popup",ref_key:"payTypeDialog",ref:C,type:"dialog","background-color":"#fff"},{default:n((()=>[c(t,{class:"pay-type-content"},{default:n((()=>[c(t,{class:"title"},{default:n((()=>[u(d(e.$t("comm.t18")),1)])),_:1}),c(m,{onChange:b,class:"type-list"},{default:n((()=>[c(o,{value:"0",class:"type",disabled:"true",checked:!0},{default:n((()=>[u(d(e.$t("trade.t45"))+" ",1),c(t,{class:"icon-shield"})])),_:1})])),_:1}),c(t,{class:"popup-handle"},{default:n((()=>[c(_,{type:"default",class:"btn btn-cancle",onClick:S},{default:n((()=>[u(d(e.$t("trade.t49")),1)])),_:1}),c(_,{type:"default",class:"btn btn-confirm",onClick:I},{default:n((()=>[u(d(e.$t("user.t45")),1)])),_:1})])),_:1})])),_:1})])),_:1},512)}}},[["__scopeId","data-v-3f2d1821"]]),K=j({__name:"order-item",props:{row:{type:Object,default:()=>{}}},emits:["reload","invertSelect"],setup(i,{emit:p}){const I=o("");N((e=>{I.value=e.goodsType}));const{t:x}=e(),$=a(),F=o(!1),T=t((()=>$.state.userinfo)),j=t((()=>$.state.configInfo));const G=o(null);let R=m({});const z=e=>{F.value=!0;let a=e.value.includes("1");L({goodsId:R.id,isShow:1,payType:a?"1":"0"}).then((e=>{625!=e.data.code?626!=e.data.code?200===e.data.code?(p("reload"),S({title:x("user.t152"),icon:"success",duration:2e3})):S({title:e.data.message,icon:"none",duration:2e3}):C({title:x("user.t80"),content:e.data.message,confirmText:x("user.t167"),success:function(e){e.confirm&&b({url:"/pages/user/payment/deposit"})}}):C({title:x("user.t80"),content:e.data.message,confirmText:x("user.t168"),success:function(e){e.confirm&&b({url:"/pages/user/payment/payment"})}})})).catch((e=>{S({title:x("message.t1"),icon:"none",duration:2e3})})).finally((()=>{F.value=!1}))};return(e,a)=>{var t,o,m,$,N,P;const A=v,E=f,L=_("van-image"),q=_("van-button"),B=O(s("w-loading"),D);return l(),y(w,null,[g("div",{class:"order-info"},[g("div",{class:"order-info__hd flex-align-center"},[g("div",{class:"order-info__orderNum"},d(e.$t("user.t147"))+": "+d(i.row.id),1),g("div",{class:"order-info__date"},d(i.row.updateTime),1)]),g("div",{class:"order-info__bd flex-align-center"},[4!=i.row.isShow&&1!=I.value?(l(),r(E,{key:0,onChange:a[0]||(a[0]=e=>{var a;1==(a=i.row).checked?(p("invertSelect",!1),a.checked=!1):(p("invertSelect",!1),a.checked=!0)})},{default:n((()=>[c(A,{checked:i.row.checked},null,8,["checked"])])),_:1})):h("",!0),c(L,{class:"order-info__img",src:k(j).imageLocalUrl+(null==(t=i.row)?void 0:t.image),fit:"scale-down",onClick:a[1]||(a[1]=e=>{return a=i.row,void b({url:`/pages/index/goodsDetail?id=${a.id}`});var a})},null,8,["src"]),g("div",{class:"order-info__cnt"},[g("div",{class:"order-info__title flex-align-center"},[g("span",{class:"order-info__t1 ellipsis1"},d(null==(o=i.row)?void 0:o.goodsName),1),g("span",{class:"order-info__t2"},d(e.$t("currencySymbol"))+d((null==(m=i.row)?void 0:m.price)||0),1)]),g("div",{class:"order-info__sub flex-align-center"},[g("div",{class:"order-info__t3"},d(e.$t("user.t148"))+": "+d(null==($=i.row)?void 0:$.cateName),1),g("div",{class:"order-info__t3"},"x "+d((null==(N=i.row)?void 0:N.stock)||0),1)]),g("div",{class:"order-info__handle"},[g("div",{class:"order-info__price"},[g("span",{class:"order-info__symbol"},d(e.$t("currencySymbol")),1),u(d(null==(P=i.row)?void 0:P.price),1)]),0==i.row.isShow?(l(),r(q,{key:0,class:"order-info__btn",color:"#1F1F1F",onClick:a[2]||(a[2]=e=>{return a=i.row,R=a,void G.value.open();var a})},{default:n((()=>[u(d(e.$t("user.t150")),1)])),_:1})):h("",!0),1==i.row.isCanRecycle?(l(),r(q,{key:1,class:"order-info__btn",color:"#1F1F1F",onClick:a[3]||(a[3]=e=>{return a=i.row,void C({title:x("user.t80"),content:x("user.t161"),success:function(e){e.confirm&&(F.value=!0,M({goodsId:a.id,totalPrice:a.price*a.stock,totalNum:a.stock,sellerId:T.value.userId}).then((e=>{200===e.data.code?(p("reload"),S({title:x("user.t162"),icon:"none",duration:2e3})):S({title:e.data.message,icon:"none",duration:2e3})})).catch((e=>{S({title:x("message.t1"),icon:"none",duration:2e3}),console.error(e)})).finally((()=>{F.value=!1})))}});var a})},{default:n((()=>[u(d(e.$t("user.t163")),1)])),_:1})):h("",!0),4==i.row.isShow?(l(),r(q,{key:2,class:"order-info__btn",color:"#1F1F1F",disabled:4==i.row.isShow},{default:n((()=>[u(d(e.$t("user.t166")),1)])),_:1},8,["disabled"])):h("",!0),1==i.row.isCanRecycle?(l(),r(q,{key:3,class:"order-info__btn",color:"#1F1F1F",plain:"",onClick:a[4]||(a[4]=e=>{return a=i.row,void b({url:"/pages/user/addresses/addresses?goodsId="+a.id});var a})},{default:n((()=>[u(d(e.$t("user.t164")),1)])),_:1})):h("",!0)])])])]),c(H,{ref_key:"payTypeRef",ref:G,confirmCallback:z},null,512),c(B,{show:F.value},null,8,["show"])],64)}}},[["__scopeId","data-v-8cb1522f"]]),U=j({__name:"shelves",setup(m){const _=a();t((()=>_.state.userinfo));const j=o(!1);o();const E=e=>{j.value=e},L=o({records:[]}),M=o(0),U=t((()=>(console.log("durationTime==========",M),parseInt(M.value/3600)))),J=t((()=>{const e=M.value%3600;return parseInt(e/60)})),Q=t((()=>M.value%60)),V=o(null),W=()=>{V.value.open()};function X(e){var a;let t=L.value.records.filter((e=>!0===e.checked)).map((e=>e.id)),o=e.value.includes("1");0!=t.length?(Z.value=!0,B({goodsId:t.toString(),userId:null==(a=_.state.userinfo)?void 0:a.userId,payType:o?"1":"0"}).then((e=>{625==e.data.code&&o?C({title:Y("user.t80"),content:e.data.message,confirmText:Y("user.t168"),success:function(e){e.confirm&&(console.log("3"),b({url:"/pages/user/payment/payment"}))}}):626!=e.data.code?200===e.data.code?(ne(),S({title:Y("user.t152"),icon:"success",duration:2e3})):S({title:e.data.message,icon:"none",duration:2e3}):C({title:Y("user.t80"),content:e.data.message,confirmText:Y("user.t167"),success:function(e){e.confirm&&b({url:"/pages/user/payment/deposit"})}})})).catch((e=>{S({title:Y("message.t1"),icon:"none",duration:2e3})})).finally((()=>{Z.value=!1}))):C({title:"Prompt",content:"Please select at least one item"})}const{t:Y}=e(),Z=o(!1),ee={pageSize:10,pageNo:1},ae=o(""),te=o(0);function oe(e){return q({...e,ownerId:_.state.userinfo.userId,isShow:1==te.value?1:"0,4"}).then((a=>{var t,o,s,l,r,n;200===a.data.code&&(1==e.pageNo?(L.value=(null==(t=a.data)?void 0:t.result)||{},M.value=null==(r=null==(l=null==(s=null==(o=a.data)?void 0:o.result)?void 0:s.records)?void 0:l[0])?void 0:r.duration):L.value={...a.data.result||{},records:L.value.records.concat((null==(n=a.data.result)?void 0:n.records)||[])})})).catch((e=>{}))}N((e=>{te.value=e.goodsType,ae.value=1==te.value?Y("user.t145"):Y("user.t146"),I({title:ae.value}),Z.value=!0,oe(ee).finally((()=>{Z.value=!1}))})),G((()=>{Z.value||(Z.value=!0,oe(ee).finally((()=>{Z.value=!1})))}));const se=[{value:"more"},{value:"loading"},{value:"noMore"}],le=o({contentdown:Y("message.t2"),contentrefresh:Y("message.t3"),contentnomore:Y("message.t4")}),re=t((()=>{var e,a,t;return(null==(e=L.value)?void 0:e.total)>(null==(t=null==(a=L.value)?void 0:a.records)?void 0:t.length)?se[1].value:se[2].value}));R((()=>{oe(ee).finally((()=>{x()}))})),z((()=>{L.value.total>L.value.records.length&&oe({pageSize:ee.pageSize,pageNo:+L.value.current+1})}));const ne=()=>{oe(ee)};return P((()=>{if(_.getters.getIsShowGuidance){let e=_.getters.getGuidanceCurrentStep;if(8==e)return e-=1,_.commit("setGuidanceCurrentStep",e<=1?1:e),!0;e-=1,_.commit("setGuidanceCurrentStep",e<=1?1:e)}})),(e,a)=>{const t=O(s("uni-countdown"),T),o=v,m=f,_=p,b=F,C=O(s("uni-load-more"),A),S=O(s("w-loading"),D),I=i;return l(),r(I,{class:"ano-page ano-myOrder"},{default:n((()=>{var s,i,v,f;return[g("div",{class:"myOrder-tabs"},[g("div",{class:"myOrder-orders-section"},[(null==(s=L.value)?void 0:s.records.length)?(l(),y("div",{key:0,class:"myOrder-orders"},[2==te.value?(l(),y("div",{key:0,class:"list-countdown"},[u(d(e.$t("user.t173_1"))+" ",1),(l(),r(t,{key:M.value,splitorColor:"#f00",color:"#f00","font-size":16,"show-day":!1,hour:k(U),minute:k(J),second:k(Q)},null,8,["hour","minute","second"])),u(" "+d(e.$t("user.t173_2")),1)])):h("",!0),(l(!0),y(w,null,$(null==(i=L.value)?void 0:i.records,(e=>(l(),y("div",{class:"myOrder-orders-row",key:e.id},[(l(),r(K,{onInvertSelect:E,row:e,key:e.id,onReload:ne},null,8,["row"]))])))),128)),1!=te.value?(l(),y("div",{key:1,class:"myOrder-Select"},[c(m,{onChange:a[0]||(a[0]=e=>{return a=e,t=L.value.records,void(0==a.detail.value.length?(t=t.forEach((e=>{e.checked=!1})),j.value=!1):(t=t.forEach((e=>{e.checked=!0})),j.value=!0));var a,t}),class:"myOrder-Group"},{default:n((()=>[c(o,{checked:L.value.records.every((e=>e.checked))},{default:n((()=>[u("Check All")])),_:1},8,["checked"])])),_:1}),c(_,{disabled:!L.value.records.some((e=>e.checked)),class:"myOrder-List",onClick:W},{default:n((()=>[u(d(e.$t("user.t150")),1)])),_:1},8,["disabled"])])):h("",!0)])):h("",!0),(null==(v=L.value)?void 0:v.records.length)||Z.value?h("",!0):(l(),y("div",{key:1,class:"ano-empty"},[g("div",{class:"ano-empty__img"}),c(b,{class:"ano-empty__text"},{default:n((()=>[u(d(e.$t("user.t144")),1)])),_:1})]))])]),c(H,{ref_key:"payTypeRef",ref:V,confirmCallback:X},null,512),(null==(f=L.value)?void 0:f.records.length)?(l(),r(C,{key:0,status:k(re),"content-text":le.value},null,8,["status","content-text"])):h("",!0),c(S,{show:Z.value},null,8,["show"])]})),_:1})}}},[["__scopeId","data-v-22b85fb3"]]);export{U as default};
