import{u as a,r as e,c as l,p as s,d as t,e as u,w as o,f as n,i,j as d,x as r,t as c,k as w,l as v,F as m,h as p,m as A,G as f,H as h,a2 as _,v as g,C as y,A as b,q as k,E as B}from"./index-1326579e.js";import{_ as D}from"./uni-easyinput.bcff0311.js";import{_ as M,e as Y,o as j,r as G}from"./uni-app.es.a60443e8.js";import{_ as V}from"./w-loading.4fc13da4.js";import{_ as x}from"./ano-popup.0d0d982a.js";import{g as I,x as P,D as C}from"./user.2b7a6c52.js";import{t as S}from"./utils.6d9bcde1.js";import"./uni-icons.e2da828d.js";const J=M({__name:"withdrawal",setup(M){const{t:J}=a(),T=n(),U=e(!1),R=l((()=>T.state.userinfo)),N=e([]);function Q(){return I({userId:R.value.userId}).then((a=>{200===a.data.code&&T.commit("setUserinfo",a.data.result)})),P({type:1,userId:T.state.userinfo.userId}).then((a=>{200===a.data.code&&(N.value=a.data.result||[],N.value.some(((a,e)=>(1==a.isDefault&&(F.value=e),1==a.isDefault))))}))}Y((a=>{s({url:"/pages/user/payment/cards?type=1&payMode=Bank"})})),U.value=!0,Q().finally((()=>{U.value=!1})),j((()=>{U.value||Q()}));const F=e(""),Z=e(""),z=()=>{Z.value=R.value.amount},E=e(!1),H=e(!0),$=e({jyPassword:"",password1:"",password2:""}),L=e("jyPassword"),O=a=>{let e=setTimeout((()=>{var a,l,s;if(clearTimeout(e),6==$.value[L.value].length)return"jyPassword"==L.value?(E.value=!1,H.value=!1,U.value=!0,void C({amount:Z.value,type:1,userId:R.value.userId,accountNo:null==(a=N.value[F.value])?void 0:a.accountNo,bank:null==(l=N.value[F.value])?void 0:l.bank,branch:null==(s=N.value[F.value])?void 0:s.branch,jyPassword:$.value[L.value]}).then((a=>{if(200!==a.data.code)return $.value[L.value]="",void f({title:a.data.message,icon:"none",duration:2e3});Z.value=0,Q(),f({title:J("user.t105"),icon:"none",duration:2e3}),setTimeout((()=>{h({delta:1})}),2e3)})).catch((a=>{f({title:J("message.t1"),icon:"none",duration:2e3})})).finally((()=>{U.value=!1}))):void 0}),17)},X=()=>{if(null!=typeof Z.value&&""!=Z.value&&"undefined"!=Z.value)if(+Z.value>+R._value.amount)f({title:"The withdrawal amount is insufficient",duration:2e3,icon:"none"});else if(Z.value&&0==+Z.value)f({title:"The withdrawal amount cannot be 0",duration:2e3,icon:"none"});else{if(!F.value&&0!==F.value)return void _({title:J("user.t80"),content:J("user.t6603"),success:function(a){a.confirm&&s({url:"/pages/user/payment/cards?type=1&payMode=Bank"})}});E.value=!0}else f({title:"Please enter the withdrawal amount",duration:2e3,icon:"none"})};return(a,e)=>{const l=g("van-radio"),n=g("van-radio-group"),f=y,h=b,_=G(k("uni-easyinput"),D),M=g("van-button"),Y=G(k("w-loading"),V),j=g("van-icon"),I=g("van-password-input"),P=g("van-number-keyboard"),C=G(k("ano-popup"),x),J=i;return t(),u(J,{class:"ano-page ano-withdrawal"},{default:o((()=>[d("div",{class:"withdrawal-section withdrawal-list"},[d("div",{class:"withdrawal-section__title"},[r(c(a.$t("user.t99"))+" ",1),d("div",{class:"withdrawal-section__link",onClick:e[0]||(e[0]=a=>{s({url:"/pages/user/payment/cards?type=1&payMode=Bank"})})},c(a.$t("comm.t21")),1)]),N.value.length?(t(),u(n,{key:0,modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a)},{default:o((()=>[(t(!0),w(m,null,v(N.value,((a,e)=>{var s,u;return t(),w("div",{class:"withdrawal-item",key:a.id},[d("div",{class:"withdrawal-item__icon"}),d("div",{class:"withdrawal-item__t1"},c(a.bankName)+"（"+c(null==(u=a.accountNo)?void 0:u.slice((null==(s=a.accountNo)?void 0:s.length)-4))+"）",1),p(l,{class:"withdrawal-item__radio",name:e,"icon-size":"1rem"},{icon:o((a=>[d("div",{class:B(["icon-radio",{"icon-radio2":a.checked}])},null,2)])),_:2},1032,["name"])])})),128))])),_:1},8,["modelValue"])):(t(),w("div",{key:1,class:"withdrawal-empty ano-empty"},[p(f,{class:"ano-empty__img",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAAAbFBMVEUAAADAxtIfLlTq7PD29/hKVnTZ3ebAxtEi2pEgj3fV2eD3+Ps1QmUgiXUfYmYfMFUh0Y4hroEgYmbi5esghnQpN1ylq7vu7/Px8vbLz9hdaIRZZIEfd24fT2AfPlm2u8iVna9/iJ5pc400QmRZaTVQAAAAAnRSTlMA+MX1txYAAAHrSURBVHja7drrbtowGIDh1i6FjnGmbOvO2/3f4zQkqiKIiSskYvt5fyOFR/mIsZw7SZIkSZIkSZIkSZIkSdLgG50p3K6T7wcMDAwMDNw7YGBgYOCjgIGBgYGBewcMDAwMfBQwcKPgeNxjZ8DAqYCBgYGBhwFer5aTcy1X6/CmasDbSXfb8Fo14PUk1es9rge8SoJXh4/VA14mwctwaDGfPfVtNl8MFzxJFw7Nn3Kalw+eZYFnwMWBmxvp5h5aIVSyLAED7wMGBgYGBgYGBr7JbunbjwrByf3wdlEfOL0b/g5cPLi5kW7uoRVCY8tSNeCeRy31gJs7TGvuuLS5A/H2XnlIBQwMDAwMDAwMDAwMfClgYGBgYGBgYGBgYOBeAQMDAwMDd/bwjmJmX57zBM+b6f8+x/yGAY6/8sC7vff0MuWA40uO92W671M8qRzw49+rDHQ54PhzkTnQ03iucsDxd1/v1+RAlwPejLIGuusa5YD7rk27Cze4HHDcZQx04olVDjj+uc5AlwPejD5eavewLznQ5YAzAgYGBgYGBgYGHlzAwMDA1wJ/yCh2Vw54nFHsDhgYGBjYsuSPx1ADBgYGBgYeUMDAwMDAwAMKuEHw/bip7u/GjQVce+39hiVJkiRJkiRJkiRJkiTduH95A6d2S4GIjgAAAABJRU5ErkJggg=="}),p(h,{class:"ano-empty__text"},{default:o((()=>[r(c(a.$t("user.t6602")),1)])),_:1})]))]),d("div",{class:"withdrawal-section withdrawal-balance"},[d("div",{class:"withdrawal-section__title"},c(a.$t("user.t100"))+": "+c(A(S)(A(R).amount)),1),d("div",{class:"withdrawal-balance__amount"},[d("div",{class:"withdrawal-balance__symbol"},c(a.$t("currencySymbol")),1),p(_,{class:"withdrawal-balance__field",modelValue:Z.value,"onUpdate:modelValue":e[2]||(e[2]=a=>Z.value=a),type:"number",name:"bank",placeholder:"100",inputBorder:!1,maxlength:"20",clearable:""},null,8,["modelValue"]),p(M,{class:"withdrawal-balance__max",plain:"",color:"#1f1f1f",onClick:z},{default:o((()=>[r(c(a.$t("user.t101")),1)])),_:1})]),d("div",{class:"withdrawal-balance__tips"},[d("div",{class:"withdrawal-balance__t1"},c(a.$t("user.t102"))+"（"+c(a.$t("currencySymbol"))+c(A(R).minCashAmount)+"-"+c(A(R).maxCashAmount)+"）",1),d("div",{class:"withdrawal-balance__icon-question"}),d("div",{class:"withdrawal-balance__t1"},c(a.$t("user.t103")),1)])]),p(M,{class:"withdrawal-confirm",color:"#1f1f1f",onClick:X},{default:o((()=>[r(c(a.$t("user.t104")),1)])),_:1}),p(Y,{show:U.value},null,8,["show"]),p(C,{class:"ano-dialog-password",show:E.value,"onUpdate:show":e[7]||(e[7]=a=>E.value=a),round:"",type:"bottom"},{default:o((()=>[d("div",{class:"dialog-password__content"},[d("div",{class:"dialog-password__title"},c(a.$t("user.t88")),1),p(j,{class:"dialog-password__close",name:"cross",onClick:e[3]||(e[3]=a=>E.value=!1)}),d("div",{class:"dialog-password__address"},[p(I,{value:$.value[L.value],focused:H.value,onFocus:e[4]||(e[4]=a=>H.value=!0)},null,8,["value","focused"]),p(P,{modelValue:$.value[L.value],"onUpdate:modelValue":e[5]||(e[5]=a=>$.value[L.value]=a),show:!0,maxlength:6,"delete-button-text":"X","extra-key":".","safe-area-inset-bottom":"",onBlur:e[6]||(e[6]=a=>E.value=!1),onInput:O},null,8,["modelValue"])])])])),_:1},8,["show"])])),_:1})}}},[["__scopeId","data-v-a7d801b5"]]);export{J as default};
