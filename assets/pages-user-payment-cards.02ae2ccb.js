import{u as a,r as s,c as e,d as l,e as t,w as o,f as u,i as d,j as n,k as i,F as r,l as c,t as v,h as _,x as p,p as m,G as f,v as w,q as g,a2 as h}from"./index-1326579e.js";import{_ as y}from"./ano-popup.0d0d982a.js";import{_ as k,o as b,r as j}from"./uni-app.es.a60443e8.js";import{_ as I}from"./w-loading.4fc13da4.js";import{x as $,y as x}from"./user.2b7a6c52.js";const C=k({__name:"cards",setup(k){const{t:C}=a(),N=u(),V=s(!1),B=e((()=>N.state.userinfo)),F=s([]),M=()=>{m({url:"/pages/user/payment/edit?type=1&payMode=Bank"})};function T(){return $({type:1,userId:N.state.userinfo.userId}).then((a=>{200===a.data.code&&(F.value=a.data.result)}))}V.value=!0,T().finally((()=>{V.value=!1})),b((()=>{V.value||T()})),s(1);const U=s(""),q=s(!1),A=s(!0),G=a=>{let s=setTimeout((()=>{clearTimeout(s),6==U.value.length&&(q.value=!1,V.value=!0,x({ids:P.value.id,jyPassword:U.value,userId:B.value.userId}).then((a=>{200===a.data.code?(T(),f({title:C("user.t89"),icon:"success",duration:2e3})):f({title:a.data.message,icon:"none",duration:2e3})})).catch((a=>{f({title:C("message.t1"),icon:"none",duration:2e3})})).finally((()=>{U.value="",V.value=!1})))}),17)},P=s({});return(a,s)=>{const e=w("van-icon"),u=w("van-button"),m=w("van-password-input"),f=w("van-number-keyboard"),k=j(g("ano-popup"),y),b=j(g("w-loading"),I),$=d;return l(),t($,{class:"ano-page ano-cards"},{default:o((()=>[n("div",{class:"cards-section cards-list"},[F.value.length?(l(),i("div",{key:0,class:"cards-list__wrap"},[(l(!0),i(r,null,c(F.value,(s=>{var e,t;return l(),i("div",{class:"cards-item",key:s.id},[n("div",{class:"cards-item__icon"}),n("div",{class:"cards-item__cnt"},[n("div",{class:"cards-item__hd"},[n("div",{class:"cards-item__t1"},v(s.bank),1),n("div",{class:"cards-item__cancel",onClick:a=>{return e=s,void h({title:C("user.t80"),content:C("user.t90"),success:function(a){a.confirm&&(P.value=e,q.value=!0)}});var e}},v(a.$t("user.t83")),9,["onClick"])]),n("div",{class:"cards-item__t2"},v(a.$t("user.t84")),1),n("div",{class:"cards-item__t3"},"**** **** **** "+v(null==(t=s.accountNo)?void 0:t.slice((null==(e=s.accountNo)?void 0:e.length)-4)),1)])])})),128))])):(l(),i("div",{key:1,class:"cards-list__empty"},v(a.$t("user.t85")),1)),_(u,{class:"cards-list__confirm",color:"#1f1f1f",plain:"",disabled:F.value.length>=3,onClick:M},{default:o((()=>[_(e,{name:"plus"}),p(v(a.$t("user.t86")),1)])),_:1},8,["disabled"]),n("div",{class:"cards-list__tips"},v(a.$t("user.t87")),1)]),_(k,{class:"ano-dialog-password",show:q.value,"onUpdate:show":s[4]||(s[4]=a=>q.value=a),round:"",type:"bottom"},{default:o((()=>[n("div",{class:"dialog-password__content"},[n("div",{class:"dialog-password__title"},v(a.$t("user.t88")),1),_(e,{class:"dialog-password__close",name:"cross",onClick:s[0]||(s[0]=a=>q.value=!1)}),n("div",{class:"dialog-password__address"},[_(m,{value:U.value,focused:A.value,onFocus:s[1]||(s[1]=a=>A.value=!0)},null,8,["value","focused"]),_(f,{modelValue:U.value,"onUpdate:modelValue":s[2]||(s[2]=a=>U.value=a),show:!0,maxlength:6,onBlur:s[3]||(s[3]=a=>q.value=!1),onInput:G},null,8,["modelValue"])])])])),_:1},8,["show"]),_(b,{show:V.value},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-d43f9332"]]);export{C as default};
