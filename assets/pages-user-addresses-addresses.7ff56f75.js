import{u as e,r as a,c as s,a7 as t,d as l,e as n,w as o,f as i,i as d,j as u,k as r,l as c,F as v,h as m,x as f,t as _,n as g,m as p,p as h,G as y,H as k,A,v as C,q as j,a2 as w}from"./index-1326579e.js";import{_ as x}from"./uni-load-more.16e4c6a9.js";import{_ as I,o as N,a as b,c as $,d as z,r as S}from"./uni-app.es.a60443e8.js";import{_ as D}from"./w-loading.4fc13da4.js";import{k as H,l as T,m as q}from"./user.2b7a6c52.js";const F=I({__name:"addresses",setup(I){const{t:F}=e(),G=i(),M=a(!1),B={pageSize:20,pageNo:1};M.value=!0,K(B).finally((()=>{M.value=!1})),N((()=>{M.value||(M.value=!0,K(B).finally((()=>{M.value=!1})))}));const E=a("");b((e=>{E.value=e.goodsId}));const J=a([]);function K(e){return H({...e,userId:G.state.userinfo.userId}).then((a=>{var s,t;200===a.data.code&&(1==e.pageNo?J.value=(null==(s=a.data)?void 0:s.result)||[]:J.value.concat((null==(t=a.data)?void 0:t.result)||[]))})).catch((e=>{}))}function L(e={}){h({url:"/pages/user/addresses/edit?id="+(e.id||"")})}function O(){var e;(null==(e=J.value)?void 0:e.length)?J.value.some((e=>1==e.isDefault))?(M.value=!0,T({goodsId:E.value}).then((e=>{if(200!==e.data.code)return void y({title:e.data.message,icon:"none",duration:2e3});y({title:F("user.t5102"),icon:"success",duration:2e3});let a=setTimeout((()=>{clearTimeout(a),k({delta:1})}),2e3)})).catch((e=>{y({title:F("message.t1"),icon:"none",duration:2e3}),console.error(e)})).finally((()=>{M.value=!1}))):y({title:F("user.t5104"),icon:"none",duration:2e3}):y({title:F("user.t5103"),icon:"none",duration:2e3})}const P=[{value:"more"},{value:"loading"},{value:"noMore"}],Q=a({contentdown:F("message.t2"),contentrefresh:F("message.t3"),contentnomore:F("message.t4")}),R=s((()=>{var e,a,s;return M.value?P[1].value:(null==(e=activeAssets.value)?void 0:e.total)>(null==(s=null==(a=activeAssets.value)?void 0:a.records)?void 0:s.length)?P[0].value:P[2].value}));return $((()=>{K(B).finally((()=>{t()}))})),z((()=>{var e;activeAssets.value.total>(null==(e=activeAssets.value)?void 0:e.records.length)&&K({pageSize:B.pageSize,pageNo:+activeAssets.value.current+1})})),(e,a)=>{const s=A,t=C("van-button"),i=S(j("uni-load-more"),x),h=S(j("w-loading"),D),k=d;return l(),n(k,{class:"ano-page ano-address"},{default:o((()=>{var a,d;return[u("div",{class:"address-list"},[(l(!0),r(v,null,c(J.value,(a=>(l(),r("div",{class:"address-item",key:a.id},[u("div",{class:"address-item__hd"},[a.isDefault?(l(),r("span",{key:0,class:"stg"},"["+_(e.$t("user.t34"))+"]",1)):g("",!0),f(" "+_(a.province+a.city+a.district),1)]),u("div",{class:"address-item__bd"},[u("div",{class:"address-item__t1"},_(a.detail),1),u("div",{class:"address-item__icon-edit",onClick:e=>L(a)},null,8,["onClick"]),u("div",{class:"address-item__icon-delete",onClick:e=>function(e={}){w({title:F("user.t80"),content:F("user.t5106"),success:function(a){a.confirm||reurn,q({ids:e.id}).then((e=>{200===e.data.code?(y({title:F("user.t5105"),icon:"success",duration:2e3}),K(B)):y({title:e.data.message,icon:"none",duration:2e3})})).catch((e=>{y({title:F("message.t1"),icon:"none",duration:2e3})})).finally((()=>{M.value=!1}))}})}(a)},null,8,["onClick"])]),u("div",{class:"address-item__fd"},[f(_(a.realName),1),u("span",{class:"address-item__t2"},_(a.phone),1)])])))),128))]),(null==(a=J.value)?void 0:a.length)||M.value?g("",!0):(l(),r("div",{key:0,class:"ano-empty"},[u("div",{class:"ano-empty__img"}),m(s,{class:"ano-empty__text"},{default:o((()=>[f(_(e.$t("user.t5101")),1)])),_:1})])),u("div",{class:"address-handle"},[m(t,{class:"address-handle__add",color:"#1f1f1f",onClick:L},{default:o((()=>[f(_(e.$t("user.t35")),1)])),_:1}),E.value?(l(),n(t,{key:0,class:"address-handle__add",color:"#1f1f1f",plain:"",onClick:O},{default:o((()=>[f(_(e.$t("user.t164")),1)])),_:1})):g("",!0)]),(null==(d=e.activeAssets)?void 0:d.records.length)?(l(),n(i,{key:1,status:p(R),"content-text":Q.value},null,8,["status","content-text"])):g("",!0),m(h,{show:M.value},null,8,["show"])]})),_:1})}}},[["__scopeId","data-v-be275b6c"]]);export{F as default};
