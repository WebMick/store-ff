import{u as e,r as a,c as l,aF as s,G as t,d as o,e as r,w as u,i as n,h as i,j as d,x as c,t as m,m as v,f as p,H as f,p as _,q as h,v as g}from"./index-1326579e.js";import{_ as V}from"./uni-easyinput.bcff0311.js";import{_ as y,a as C,r as b}from"./uni-app.es.a60443e8.js";import{_ as x,a as $}from"./uni-forms.67fb2978.js";import{_ as j}from"./w-loading.4fc13da4.js";import{n as N,q as k}from"./user.2b7a6c52.js";import"./uni-icons.e2da828d.js";const q=y({__name:"edit",setup(y){const{t:q}=e(),w=p(),B=a(!1),U=l((()=>w.state.userinfo)),D=l((()=>w.state.areaCode)),I=a({realName:"",phone:"",region:"",province:"",city:"",district:"",detail:"",postCode:"",isDefault:0}),T={realName:[{required:!0,message:q("user.t46")}],phone:[{required:!0,message:q("user.t47")}],region:[{required:!0,message:q("user.t48")}],detail:[{required:!0,message:q("user.t49")}],postCode:[{required:!0,message:q("user.t4302")}]},A=a(null);let F="",G=q("user.t50");const H=a("");C((e=>{F=e.id||"",H.value=e.payMode,e.id&&(G=q("user.t51"),s({title:G}),B.value=!0,N({id:e.id}).then((e=>{200===e.data.code?(I.value={...e.data.result||{}},I.value.region=I.value.province+"/"+I.value.city+"/"+I.value.district):toast({title:e.data.message})})).catch((e=>{t({title:q("message.t1"),icon:"success",duration:2e3})})).finally((()=>{B.value=!1})))}));const M=a([]),P=l((()=>{var e;return(null==(e=M.value[R.value[0]])?void 0:e.children)||[]}));l((()=>{var e;return(null==(e=P.value[R.value[1]])?void 0:e.children)||[]}));const R=a([0,0,0]),S=()=>{var e;null==(e=A.value)||e.validate().then((e=>{let a={...I.value,areaCode:D.value,userId:w.state.userinfo.userId};F&&(a.id=F),B.value=!0,k(a).then((e=>{if(200!==e.data.code)return void t({title:e.data.message,icon:"none",duration:2e3});t({title:q("user.t33"),icon:"success",duration:2e3});let a=setTimeout((()=>{clearTimeout(a),f({delta:1})}),2e3)})).catch((e=>{t({title:q("message.t1"),icon:"none",duration:2e3})})).finally((()=>{B.value=!1}))}))},z=()=>{_({url:"/pages/states/states"})};return(e,a)=>{const l=b(h("uni-easyinput"),V),s=b(h("uni-forms-item"),x),t=g("van-switch"),p=b(h("uni-forms"),$),f=g("van-button"),_=b(h("w-loading"),j),y=n;return o(),r(y,{class:"ano-page ano-address"},{default:u((()=>[i(p,{class:"ano-form payment-form",ref_key:"formRef",ref:A,rules:T},{default:u((()=>[i(s,{class:"ano-form__item",name:"realName"},{default:u((()=>[d("div",{class:"ano-form__label"},[d("span",{class:"ano-asterisk"},"*"),c(m(e.$t("user.t36")),1)]),d("div",{class:"ano-form__cnt"},[i(l,{type:"text",modelValue:I.value.realName,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value.realName=e),placeholder:e.$t("user.t37"),rules:T.realName,inputBorder:!1,maxlength:"20",clearable:""},null,8,["modelValue","placeholder","rules"])])])),_:1}),i(s,{class:"ano-form__item",name:"phone"},{default:u((()=>[d("div",{class:"ano-form__label"},[d("span",{class:"ano-asterisk"},"*"),c(m(e.$t("user.t38")),1)]),d("div",{class:"ano-form__cnt flex-align-center"},[d("div",{class:"ano-form__pre flex-align-center",onClick:z},[d("div",{class:"ano-form__pre-area"},"+"+m(v(D)||v(U).areaCode),1),d("div",{class:"ano-form__pre-icon"})]),i(l,{type:"idcard",modelValue:I.value.phone,"onUpdate:modelValue":a[1]||(a[1]=e=>I.value.phone=e),placeholder:e.$t("user.t39"),rules:T.phone,inputBorder:!1,maxlength:"20",clearable:""},null,8,["modelValue","placeholder","rules"])])])),_:1}),i(s,{class:"ano-form__item",name:"detail"},{default:u((()=>[d("div",{class:"ano-form__label"},[d("span",{class:"ano-asterisk"},"*"),c(m(e.$t("user.t42")),1)]),d("div",{class:"ano-form__cnt"},[i(l,{type:"text",modelValue:I.value.detail,"onUpdate:modelValue":a[2]||(a[2]=e=>I.value.detail=e),placeholder:e.$t("user.t43"),rules:T.detail,inputBorder:!1,maxlength:"100",clearable:""},null,8,["modelValue","placeholder","rules"])])])),_:1}),i(s,{class:"ano-form__item",name:"postCode"},{default:u((()=>[d("div",{class:"ano-form__label"},[d("span",{class:"ano-asterisk"},"*"),c(m(e.$t("user.t4303")),1)]),d("div",{class:"ano-form__cnt"},[i(l,{type:"text",modelValue:I.value.postCode,"onUpdate:modelValue":a[3]||(a[3]=e=>I.value.postCode=e),placeholder:e.$t("user.t4301"),rules:T.postCode,inputBorder:!1,maxlength:"100",clearable:""},null,8,["modelValue","placeholder","rules"])])])),_:1}),d("div",{class:"ano-form__item ano-form__switch"},[d("div",{class:"ano-form__label"},m(e.$t("user.t44")),1),d("div",{class:"ano-form__cnt"},[i(t,{modelValue:I.value.isDefault,"onUpdate:modelValue":a[4]||(a[4]=e=>I.value.isDefault=e),"active-color":"#1c1c1c","inactive-color":"#fff","active-value":1,"inactive-value":0},null,8,["modelValue"])])])])),_:1},512),i(f,{class:"address-confirm",color:"#1f1f1f",disabled:!(I.value.realName&&I.value.phone&&I.value.postCode&&I.value.detail),onClick:S},{default:u((()=>[c(m(e.$t("user.t45")),1)])),_:1},8,["disabled"]),i(_,{show:B.value},null,8,["show"])])),_:1})}}},[["__scopeId","data-v-955a403f"]]);export{q as default};
